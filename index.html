<script>
  // --- Detecci√≥n b√°sica ---
  const ua = navigator.userAgent;
  const isMobile =
    /Android|iPhone|iPad|iPod/i.test(ua) &&
    !/Macintosh; Intel Mac OS X/i.test(ua); // distingue iPadOS en desktop

  // --- Selector manual (opcional) ---
  // A√±ade un selector simple para forzar el modo cuando quieras
  (function addModeSelector(){
    const wrap = document.querySelector('.container');
    const bar = document.createElement('div');
    bar.style.display = 'flex';
    bar.style.justifyContent = 'flex-end';
    bar.style.gap = '8px';
    bar.style.marginBottom = '8px';

    const label = document.createElement('label');
    label.textContent = 'Modo de env√≠o:';
    label.style.fontSize = '12px';
    label.style.color = '#666';

    const sel = document.createElement('select');
    sel.id = 'modoEnvio';
    sel.style.fontSize = '12px';
    ['Auto','Web WA','Mobile WA'].forEach(v=>{
      const o=document.createElement('option'); o.value=v; o.textContent=v; sel.appendChild(o);
    });

    bar.appendChild(label); bar.appendChild(sel);
    wrap.insertBefore(bar, wrap.firstChild);
  })();

  // --- Icon sets ---
  const iconsMobile = {
    fecha: 'üìÖ',
    info:  '‚ÑπÔ∏è',
    dec:   'üìù',
    tomar: 'üìå'
  };
  const iconsWeb = {
    fecha: 'FECHA',
    info:  'INFORMATIVO',
    dec:   'DECISI√ìN',
    tomar: 'DECISI√ìN A TOMAR'
  };

  function getMode(){
    const forced = document.getElementById('modoEnvio')?.value || 'Auto';
    if (forced === 'Web WA')   return 'web';
    if (forced === 'Mobile WA')return 'mobile';
    return isMobile ? 'mobile' : 'web';
  }

  function getIcons(){
    return getMode()==='mobile' ? iconsMobile : iconsWeb;
  }

  // Pintar fecha en cabecera con el √≠cono/etiqueta correcto
  function renderHeader(){
    const mode = getMode();
    const i = getIcons();
    const fechaLbl = document.querySelector('p strong');
    if (fechaLbl) fechaLbl.textContent = (mode==='mobile' ? `${i.fecha} FECHA:` : `${i.fecha}:`);
  }

  renderHeader();
  document.getElementById('modoEnvio').addEventListener('change', renderHeader);

  // Env√≠o a WhatsApp (wa.me siempre, para que funcione en Safari y visores embebidos)
  document.getElementById("btnEnviar").addEventListener("click", function () {
    const numero = "51969596608";
    const fechaHora = new Date().toLocaleString("es-PE", { timeZone: "America/Lima" });

    const informativo = document.getElementById("informativo").value.trim();
    const decision = document.getElementById("decision").value.trim();
    const decisionTomar = document.getElementById("decisionTomar").value.trim();

    const mode  = getMode();
    const i     = getIcons();

    let mensaje = mode==='mobile'
      ? `${i.fecha} *Fecha y hora:* ${fechaHora}\n`
      : `${i.fecha}: ${fechaHora}\n`;

    mensaje += "------------------------------\n";
    if (informativo) mensaje += (mode==='mobile'
      ? `${i.info} *Informativo:*\n${informativo}\n\n`
      : `${i.info}:\n${informativo}\n\n`);
    if (decision) mensaje += (mode==='mobile'
      ? `${i.dec} *Decisi√≥n:*\n${decision}\n\n`
      : `${i.dec}:\n${decision}\n\n`);
    if (decisionTomar) mensaje += (mode==='mobile'
      ? `${i.tomar} *Decisi√≥n a tomar:*\n${decisionTomar}\n\n`
      : `${i.tomar}:\n${decisionTomar}\n\n`);

    this.href = `https://wa.me/${numero}?text=${encodeURIComponent(mensaje)}`;
  });
</script>
